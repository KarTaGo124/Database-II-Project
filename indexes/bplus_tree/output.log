=== TESTING UNCLUSTERED B+ Tree with DatabaseManager and CSV Data (DISK I/O) ===
NO RAM - Pure disk operations using DatabaseManager

Loading REAL sales data from: sales_dataset_unsorted.csv
Data will be saved to: /home/zamirlm/Documents/Utec/Ciclo2025-2/BD2/Database-II-Project/indexes/bplus_tree/test_data_unclustered/sales_btree_unclustered.dat
CSV structure (semicolon separated):
   Headers: ﻿ID de la venta;Nombre producto;Cantidad vendida;Precio unitario;Fecha de venta
   Sample: 403;Drone;2;1890.45;24/10/2024

Table created with BTREE index (DISK ONLY): True
Database directory: /home/zamirlm/Documents/Utec/Ciclo2025-2/BD2/Database-II-Project/indexes/bplus_tree/test_data_unclustered
Primary index type: BTREE
Secondary index on product_name: True

LOADING REAL SALES DATA INTO DISK-BASED UNCLUSTERED B+ TREE
Error writing page 1: Page data too large: 4258 > 4096
Error writing page 1: Page data too large: 4256 > 4096
Error writing page 1: Page data too large: 4257 > 4096
Error writing page 1: Page data too large: 4260 > 4096
Error writing page 1: Page data too large: 4259 > 4096
Error writing page 1: Page data too large: 4267 > 4096
Error writing page 1: Page data too large: 4257 > 4096
Error writing page 1: Page data too large: 4255 > 4096
Error writing page 0: Page data too large: 4277 > 4096
Error writing page 0: Page data too large: 4269 > 4096
Error writing page 1: Page data too large: 4248 > 4096
Error writing page 0: Page data too large: 4268 > 4096
Error writing page 1: Page data too large: 4250 > 4096
Error writing page 1: Page data too large: 4257 > 4096
Inserted 50 records - Latest: Sale 746 - Proyector 4K
   Primary Disk I/O: 25 reads, 17 writes
Error writing page 0: Page data too large: 4267 > 4096
Error writing page 1: Page data too large: 4257 > 4096
Error writing page 0: Page data too large: 4278 > 4096
Error writing page 1: Page data too large: 4257 > 4096
Error writing page 0: Page data too large: 4266 > 4096
Error writing page 1: Page data too large: 4266 > 4096
Error writing page 0: Page data too large: 4268 > 4096
Error writing page 1: Page data too large: 4269 > 4096
Error writing page 1: Page data too large: 4260 > 4096
Error writing page 0: Page data too large: 4277 > 4096
Error writing page 1: Page data too large: 4250 > 4096
Error writing page 0: Page data too large: 4266 > 4096
Error writing page 1: Page data too large: 4266 > 4096
Error writing page 1: Page data too large: 4251 > 4096
Error writing page 1: Page data too large: 4256 > 4096
Error writing page 0: Page data too large: 4267 > 4096
Error writing page 1: Page data too large: 4267 > 4096
Error writing page 0: Page data too large: 4282 > 4096
Error writing page 1: Page data too large: 4251 > 4096
Error writing page 1: Page data too large: 4266 > 4096
Error writing page 1: Page data too large: 4269 > 4096
Error writing page 0: Page data too large: 4266 > 4096
Error writing page 1: Page data too large: 4261 > 4096
Error writing page 0: Page data too large: 4270 > 4096
Error writing page 1: Page data too large: 4266 > 4096
Error writing page 1: Page data too large: 4253 > 4096
Error writing page 1: Page data too large: 4255 > 4096
Error writing page 0: Page data too large: 4282 > 4096
Error writing page 0: Page data too large: 4271 > 4096
Error writing page 1: Page data too large: 4271 > 4096
Error writing page 0: Page data too large: 4270 > 4096
Error writing page 1: Page data too large: 4258 > 4096
Error writing page 1: Page data too large: 4260 > 4096
Error writing page 0: Page data too large: 4277 > 4096
Error writing page 0: Page data too large: 4291 > 4096
Error writing page 1: Page data too large: 4269 > 4096
Error writing page 0: Page data too large: 4282 > 4096
Error writing page 0: Page data too large: 4265 > 4096
Error writing page 0: Page data too large: 4268 > 4096
Error writing page 1: Page data too large: 4264 > 4096
Error writing page 0: Page data too large: 4270 > 4096
Error writing page 0: Page data too large: 4272 > 4096
Error writing page 1: Page data too large: 4257 > 4096
Error writing page 1: Page data too large: 4262 > 4096
Error writing page 0: Page data too large: 4271 > 4096
Error writing page 0: Page data too large: 4269 > 4096
Error writing page 1: Page data too large: 4253 > 4096
Error writing page 1: Page data too large: 4275 > 4096
Error writing page 1: Page data too large: 4270 > 4096
Error writing page 1: Page data too large: 4263 > 4096
Inserted 100 records - Latest: Sale 653 - Lector de Huellas
   Primary Disk I/O: 21 reads, 6 writes
Demo completed with 100 unique records

REAL CSV LOADING PERFORMANCE:
   Time: 1.267 seconds
   Lines processed: 100
   Unique records inserted: 100
   Avg time per record: 12.67 ms
   Tables: 1
   Records in sales_secondary table: 0

TESTING PRIMARY KEY SEARCH OPERATIONS (FROM DISK)
FOUND Sale 403: Drone - Qty: 2, Price: $1890.45
FOUND Sale 56: Telescopio Digital - Qty: 11, Price: $904.34
FOUND Sale 107: Ebook Reader - Qty: 19, Price: $1914.64
FOUND Sale 402: Cargador Solar Portátil - Qty: 40, Price: $494.54
NOT FOUND Sale 999999

PRIMARY SEARCH PERFORMANCE (DISK ONLY):
   Time: 0.014 seconds
   Searches: 5
   Avg time per search: 2.72 ms
   Total disk reads: 11
   Total disk writes: 0

TESTING SECONDARY INDEX SEARCH (UNCLUSTERED B+ TREE FROM DISK)
NOT FOUND any sales for 'Drone'
NOT FOUND any sales for 'Mouse'
NOT FOUND any sales for 'Keyboard'
NOT FOUND any sales for 'Monitor'
NOT FOUND any sales for 'NonExistentProduct'

SECONDARY INDEX SEARCH PERFORMANCE (UNCLUSTERED B+ TREE - DISK ONLY):
   Time: 0.001 seconds
   Searches: 5
   Avg time per search: 0.19 ms
   Total disk reads: 30
   Total disk writes: 0

TESTING RANGE SEARCH ON PRIMARY KEY (FROM DISK)
RANGE SEARCH [50-150] (DISK ONLY):
   Time: 0.002 seconds
   Results: 6 sales records
   Disk reads: 2
   Disk writes: 0
   - Sale 50: Detector de Humo... - $756.82
   - Sale 56: Telescopio Digital... - $904.34
   - Sale 82: Robot Aspiradora... - $321.63
   - Sale 92: Lentes de Realidad Aument... - $55.26
   - Sale 107: Ebook Reader... - $1914.64
   ... and 1 more sales

FINAL DISK STORAGE ANALYSIS:
   Database directory: /home/zamirlm/Documents/Utec/Ciclo2025-2/BD2/Database-II-Project/indexes/bplus_tree/test_data_unclustered
   Primary index directory: /home/zamirlm/Documents/Utec/Ciclo2025-2/BD2/Database-II-Project/indexes/bplus_tree/test_data_unclustered/primary
   Primary B+ Tree files: ['btree_primary.pkl.dat']
   Primary file btree_primary.pkl.dat: 1150976 bytes (1124.0 KB)
   Secondary index directory: /home/zamirlm/Documents/Utec/Ciclo2025-2/BD2/Database-II-Project/indexes/bplus_tree/test_data_unclustered/secondary
   Secondary B+ Tree files: ['sales_secondary_product_name_btree.dat']
   Secondary file sales_secondary_product_name_btree.dat: 356368 bytes (348.0 KB)
   Storage efficiency: ~3564 bytes per record pointer
   Single binary file per index (not multiple files)
   Page addressing: offset = page_id × 4096

PROOF: UNCLUSTERED B+ Tree is 100% DISK-BASED
   Every insert triggered disk write operations for both primary and secondary indexes
   Every search triggers disk read operations
   Real 1ms I/O delays for each disk operation
   Data stored in fixed 4KB pages
   NO in-memory caching whatsoever
   Secondary index stores RecordPointers, not full records

DEMONSTRATING NO CACHING:
   Searching secondary index again... (should read from disk)

CONCLUSION: UNCLUSTERED B+ Tree with DatabaseManager and CSV data
   Successfully loaded real sales data using DatabaseManager
   Primary index (clustered) and secondary index (unclustered) both use disk I/O
   All operations use disk I/O (no RAM)
   Architecture matches real DBMS systems with secondary indexes
   Files saved in local bplus_tree folder!

=== UNCLUSTERED DATABASE MANAGER CSV TEST COMPLETED SUCCESSFULLY ===
